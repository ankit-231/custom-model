@api_view(["POST"])
@permission_classes([IsAuthenticated])
def addstdtosecapi(request):
    serializer = AddStdToSecApiSerializer(data=request.data)
    if serializer.is_valid():
        try:
            student = StudentsNew.objects.get(id=request.data["studentid"])
            section = Section.objects.get(id=request.data["sectionid"])
        except:
            return Response({"error":"student or section with this id does not exist"}, status=status.HTTP_400_BAD_REQUEST)
        
        

        if request.method == "POST":
            if serializer.is_valid():
                print(request.data['studentid'])
                print(student.section)
                if student.section is None:
                    student.section = section
                    student.save()
                    return Response(f"{student.username} is added to the section {student.section.sectionname}", status=status.HTTP_200_OK)
                else:
                    before_section = student.section.sectionname
                    student.section = section
                    student.save()
                    return Response(f"{student.username}'s section is updated from {before_section} to {student.section.sectionname}", status=status.HTTP_200_OK)

    return Response(serializer.errors)